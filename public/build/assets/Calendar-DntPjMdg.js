import{K as oe,r as o,j as e,L as me,S as L,t as W}from"./app-DPpDHeot.js";import{B as u,c as m}from"./button-5rleQZWM.js";import{C as y,a as N,b as v,c as M,B as S}from"./badge-CFN1t7oJ.js";import{D as he,a as xe,b as ue,c as pe,d as je}from"./dialog-DkrQp40h.js";import{I as T}from"./input-COP_1Vis.js";import{L as p}from"./label-C1fLm_eJ.js";import{T as ge}from"./textarea-B_jcpVq1.js";import{S as Y,a as B,b as P,c as V,d as g}from"./select-D_-oFfTY.js";import{T as fe,a as ye,b as D,c as E}from"./tabs-C7u14ITc.js";import{A as Ne}from"./app-layout-pfywDKmM.js";import{D as ve}from"./delete-modal-QbHdlvH-.js";import{s as H,e as z,a as Me,f as c,C as Se,b as we,c as be,i as R,d as Ce,g as K,h as U,j as q,k,l as Te,m as De}from"./chevron-left-DVhUEhkW.js";import{P as Ee}from"./plus-CdmwrR6C.js";import{C as ke,a as Oe}from"./user-menu-content-hWpYs5TB.js";import{T as Fe}from"./trash-2-CbjWmO0B.js";import{T as G}from"./triangle-alert-QfRg5BbL.js";import{C as Ae}from"./clock-EcQdvfUe.js";import"./x-asu3yKNk.js";import"./createLucideIcon-zIaxm-Kn.js";import"./index-Bd5eS0n0.js";import"./index-YHXoRFnw.js";import"./index-4LPP99tq.js";import"./chevron-down-C-P2bKL0.js";import"./check-Bkjf0qNY.js";import"./users-4iRM-hWf.js";import"./graduation-cap-D5cTDl-E.js";import"./mail-BTH67ex-.js";import"./alert-dialog-BqqnFlMX.js";import"./unlink-ha6bpkkP.js";import"./app-logo-icon-C8-wOQb5.js";const Ie=[{title:"Calendar",href:"admin/calendar"}];function mt({eventsData:J}){const{auth:Q}=oe().props,[r,O]=o.useState(new Date),[h,X]=o.useState(()=>J.map(t=>({...t,date:new Date(t.date)}))),[l,w]=o.useState(null),[Z,b]=o.useState(!1),[s,x]=o.useState({title:"",description:"",date:"",time:"",type:"schedule",priority:"low"}),_=H(r),ee=z(r),te=Me({start:_,end:ee}),C=t=>h.filter(a=>R(a.date,t)),se=()=>{if(!l||!s.title)return;const t=d=>{const i=d.getFullYear(),n=String(d.getMonth()+1).padStart(2,"0"),ce=String(d.getDate()).padStart(2,"0");return`${i}-${n}-${ce}`},a={id:Date.now().toString(),title:s.title,description:s.description,date:l,time:s.time,type:s.type,priority:s.priority};console.log(a),L.post(route("admin.addSchedule"),{title:s.title,description:s.description,date:t(l),time:s.time||null,type:s.type,priority:s.priority},{onSuccess:()=>{W.success("Success creating an event"),console.log("Success creating an event"),L.post(route("admin.addActivity"),{type:"schedule",user:Q.user.name,action:`Set ${s.type==="schedule"?"an event":"a deadline"} `,details:`${s==null?void 0:s.title} ${t(l)}`},{}),X([...h,a]),b(!1)},onError:d=>{console.error("Error creating an event",d),W.error("Error creating an event.")}}),x({title:"",description:"",time:"",date:"",type:"schedule",priority:"medium"})},j=t=>{switch(t){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},f=t=>t==="deadline"?e.jsx(G,{className:"w-3 h-3"}):e.jsx(Ae,{className:"w-3 h-3"}),F=t=>{const a=U(t),d=q(t);return h.filter(i=>k(i.date,{start:a,end:d})).sort((i,n)=>i.date.getTime()-n.date.getTime())},A=t=>{const a=H(t),d=z(t);return h.filter(i=>k(i.date,{start:a,end:d})).sort((i,n)=>i.date.getTime()-n.date.getTime())},I=t=>{const a=Te(t),d=De(t);return h.filter(i=>k(i.date,{start:a,end:d})).sort((i,n)=>i.date.getTime()-n.date.getTime())},[ae,$]=o.useState(!1),[re,ie]=o.useState(0),[le,de]=o.useState(""),ne=async t=>{$(!0),de(t.title),ie(t.id)};return e.jsxs(Ne,{breadcrumbs:Ie,children:[e.jsx(me,{title:"Calendar"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Calendar Scheduler"}),e.jsxs(he,{open:Z,onOpenChange:b,children:[e.jsx(xe,{asChild:!0,children:e.jsxs(u,{onClick:()=>{l||w(new Date)},children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Add Event"]})}),e.jsxs(ue,{children:[e.jsx(pe,{children:e.jsx(je,{children:"Add New Event"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"title",children:"Title"}),e.jsx(T,{id:"title",value:s.title,onChange:t=>x({...s,title:t.target.value}),placeholder:"Event title"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"description",children:"Description"}),e.jsx(ge,{id:"description",value:s.description,onChange:t=>x({...s,description:t.target.value}),placeholder:"Event description"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"date",children:"Date"}),e.jsx(T,{id:"date",type:"date",value:l?c(l,"yyyy-MM-dd"):"",onChange:t=>{t.target.value&&w(new Date(t.target.value))}})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"time",children:"Time"}),e.jsx(T,{id:"time",type:"time",value:s.time,onChange:t=>x({...s,time:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"type",children:"Type"}),e.jsxs(Y,{value:s.type,onValueChange:t=>x({...s,type:t}),children:[e.jsx(B,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(g,{value:"schedule",children:"Schedule"}),e.jsx(g,{value:"deadline",children:"Deadline"})]})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"priority",children:"Priority"}),e.jsxs(Y,{value:s.priority,onValueChange:t=>x({...s,priority:t}),children:[e.jsx(B,{children:e.jsx(P,{})}),e.jsxs(V,{children:[e.jsx(g,{value:"low",children:"Low"}),e.jsx(g,{value:"medium",children:"Medium"}),e.jsx(g,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(u,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(u,{onClick:se,children:"Add Event"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(y,{className:"lg:col-span-2",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),c(r,"MMMM yyyy")]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{variant:"outline",size:"icon",onClick:()=>O(we(r)),children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"icon",onClick:()=>O(be(r,1)),children:e.jsx(Oe,{className:"w-4 h-4"})})]})]})}),e.jsxs(M,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"p-2 text-center text-sm font-medium text-muted-foreground",children:t},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:te.map(t=>{const a=C(t),d=l&&R(t,l),i=Ce(t,r);return e.jsxs("div",{className:m("min-h-[80px] p-1 border rounded-lg cursor-pointer transition-colors",i?"bg-background":"bg-muted/50",d&&"ring-2 ring-primary",K(t)&&"bg-primary/10 border-primary"),onClick:()=>w(t),children:[e.jsx("div",{className:m("text-sm font-medium mb-1",!i&&"text-muted-foreground",K(t)&&"text-primary font-bold"),children:c(t,"d")}),e.jsxs("div",{className:"space-y-1",children:[a.slice(0,2).map(n=>e.jsxs("div",{className:m("text-xs p-1 rounded flex items-center gap-1 truncate",n.type==="deadline"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:[f(n.type),e.jsx("span",{className:"truncate",children:n.title})]},n.id)),a.length>2&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",a.length-2," more"]})]})]},t.toISOString())})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(v,{children:l?c(l,"MMMM d, yyyy"):"Select a date"})}),e.jsx(M,{children:l?e.jsx("div",{className:"space-y-3",children:C(l).length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No events for this date"}):C(l).sort((t,a)=>t.time.localeCompare(a.time)).map(t=>e.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:t.type==="deadline"?"destructive":"default",children:t.type}),e.jsx("div",{className:m("w-2 h-2 rounded-full",j(t.priority))}),e.jsx(u,{variant:"outline",className:"cursor-pointer",onClick:()=>ne(t),children:e.jsx(Fe,{className:"text-red-600 h-4 w-4"})})]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description}),t.time&&e.jsx("p",{className:"text-sm font-medium",children:t.time})]},t.id))}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"Click on a date to view events"})})]}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(v,{children:"Scheduled Events"})}),e.jsx(M,{children:e.jsxs(fe,{defaultValue:"week",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-3",children:[e.jsx(D,{value:"week",children:"This Week"}),e.jsx(D,{value:"month",children:"This Month"}),e.jsx(D,{value:"year",children:"This Year"})]}),e.jsxs(E,{value:"week",className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:[c(U(r),"MMM d")," - ",c(q(r),"MMM d, yyyy")]}),F(r).filter(t=>t.type==="schedule").length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No scheduled events this week"}):F(r).filter(t=>t.type==="schedule").map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-lg",children:[f(t.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c(t.date,"EEE, MMM d")," ",t.time&&`at ${t.time}`]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{variant:t.type==="deadline"?"destructive":"secondary",className:"text-xs",children:t.type}),e.jsx("div",{className:m("w-2 h-2 rounded-full",j(t.priority))})]})]},t.id))]}),e.jsxs(E,{value:"month",className:"space-y-3 mt-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:c(r,"MMMM yyyy")}),A(r).filter(t=>t.type==="schedule").length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No scheduled events this month"}):A(r).filter(t=>t.type==="schedule").map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-lg",children:[f(t.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c(t.date,"MMM d")," ",t.time&&`at ${t.time}`]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{variant:t.type==="deadline"?"destructive":"secondary",className:"text-xs",children:t.type}),e.jsx("div",{className:m("w-2 h-2 rounded-full",j(t.priority))})]})]},t.id))]}),e.jsxs(E,{value:"year",className:"space-y-3 mt-4",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-2",children:c(r,"yyyy")}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:I(r).filter(t=>t.type==="schedule").length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No scheduled events this year"}):I(r).filter(t=>t.type==="schedule").map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-lg",children:[f(t.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c(t.date,"MMM d, yyyy")," ",t.time&&`at ${t.time}`]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{variant:t.type==="deadline"?"destructive":"secondary",className:"text-xs",children:t.type}),e.jsx("div",{className:m("w-2 h-2 rounded-full",j(t.priority))})]})]},t.id))})]})]})})]}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(v,{children:"Upcoming Deadlines"})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[h.filter(t=>t.type==="deadline"&&t.date>=new Date).sort((t,a)=>t.date.getTime()-a.date.getTime()).slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 border rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 text-red-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:t.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c(t.date,"MMM d")," ",t.time&&`at ${t.time}`]})]}),e.jsx("div",{className:m("w-2 h-2 rounded-full",j(t.priority))})]},t.id)),h.filter(t=>t.type==="deadline"&&t.date>=new Date).length===0&&e.jsx("p",{className:"text-muted-foreground text-sm",children:"No upcoming deadlines"})]})})]})]})]}),e.jsx(ve,{open:ae,onOpenChange:$,id:re,title:"Delete event",routeLink:"admin.deleteSchedule",description:`This will permanently delete the "${le}" event`,toastMessage:"Event deleted",buttonTitle:"Confirm",type:"delete",additionalInfo:["Scheduled event will get deleted","You can re-create the event later if needed","All data associated with the event will also get deleted"]})]})]})}export{mt as default};
