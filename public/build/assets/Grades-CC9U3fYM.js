import{r as m,j as e,L as P}from"./app-BO0vCXdd.js";import{C as j,a as p,b as g,c as f,d as Q,B as v}from"./badge-BQWc2iXb.js";import{B as J}from"./button-BNzxi-u_.js";import{T as K,a as W,b as z,c as C,d as X,e as A}from"./table-_87czVJc.js";import{C as Z,A as ee,c as se}from"./user-menu-content-qervpgH4.js";import{I as H}from"./input-gypNOQko.js";import{S as T,a as F,b as L,c as E,d as x}from"./select-REPGTHeS.js";import{H as te}from"./header-layout-QciiuGeW.js";import{B as D}from"./book-open-Aiq0VYGO.js";import{U as G}from"./users-B5Av-R46.js";import{F as re}from"./file-text-Dgem8q6c.js";import{F as le}from"./filter-BkbjYMNt.js";import{S as V}from"./search-vbg9sFiu.js";import{C as ae}from"./clock-BU01FspC.js";import"./graduation-cap-BoIJkwZ1.js";import"./x-CWcDRnX-.js";import"./index-1KhAycrp.js";import"./index-BwtLRDEp.js";import"./app-logo-icon-CepKvpxW.js";import"./index-Bu15VQIu.js";import"./check-DzCLIzRK.js";import"./menu-BJY_q0EI.js";import"./award-BW1fHWe6.js";function B(a){return a.questions.reduce((t,c)=>t+c.points,0)}function ne(a,t){const c=a/t*100;return c>=90?"text-green-600":c>=80?"text-blue-600":c>=70?"text-yellow-600":c>=60?"text-orange-600":"text-red-600"}function ce(a){const t=a.toLowerCase();return t.includes("quiz")?"bg-blue-100 text-blue-800":t.includes("exam")?"bg-red-100 text-red-800":t.includes("project")?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}function S(a){if(a.students&&a.students.length>0)return a.students;const t=new Map;return a.assessments.forEach(c=>{c.grades.forEach(i=>{t.has(i.student.id)||t.set(i.student.id,i.student)})}),Array.from(t.values())}function ie(a,t){const c=a.grades.find(i=>i.student_id===t);return c?c.score:0}function de(a){return new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function _e({instructor:a,subjects:t,assessmentTypes:c}){const[i,I]=m.useState(t.length>0?t[0].code:""),[h,_]=m.useState(""),[N,$]=m.useState(""),[y,q]=m.useState("all"),[b,Y]=m.useState("all");m.useEffect(()=>{console.log(t)},[t]);const M=t.length,U=t.reduce((s,r)=>s+r.assessments.length,0),k=new Set;t.forEach(s=>{s.assessments.forEach(r=>{r.grades.forEach(n=>{k.add(n.student_id)})})});const O=k.size,l=t.find(s=>s.code===i),R=t.reduce((s,r)=>{const n={id:`${r.course.id}-${r.year_level}-${r.section}`,label:`${r.course.code} - Year ${r.year_level} - Section ${r.section}`};return s.some(d=>d.id===n.id)||s.push(n),s},[]),u=b==="all"?t:t.filter(s=>{const[r,n,d]=b.split("-");return s.course.id.toString()===r&&s.year_level.toString()===n&&s.section===d});m.useEffect(()=>{i&&!u.find(s=>s.code===i)&&I(u.length>0?u[0].code:"")},[u,i]);const w=s=>S(s).filter(n=>n.name.toLowerCase().includes(h.toLowerCase())||n.email.toLowerCase().includes(h.toLowerCase())),o=s=>s.assessments.filter(r=>{const n=r.title.toLowerCase().includes(N.toLowerCase())||r.description.toLowerCase().includes(N.toLowerCase()),d=y==="all"||r.title.toLowerCase().includes(y.toLowerCase());return n&&d});return e.jsxs(te,{children:[e.jsx(P,{title:"Grades"}),e.jsx("div",{className:"min-h-screen mt-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Subjects"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(f,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active this semester"})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Students"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(f,{children:[e.jsx("div",{className:"text-2xl font-bold",children:O}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all subjects"})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Assessments"}),e.jsx(re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(f,{children:[e.jsx("div",{className:"text-2xl font-bold",children:U}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total assignments"})]})]})]}),e.jsxs(j,{className:"mb-6",children:[e.jsx(p,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"Filters & Search"]})}),e.jsxs(f,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Course/Year/Section"}),e.jsxs(T,{value:b,onValueChange:Y,children:[e.jsx(F,{className:"cursor-pointer",children:e.jsx(L,{placeholder:"All courses/years/sections"})}),e.jsxs(E,{children:[e.jsx(x,{value:"all",children:"All Courses/Years/Sections"}),R.map(s=>e.jsx(x,{value:s.id,children:s.label},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Subject"}),e.jsxs(T,{value:i,onValueChange:I,children:[e.jsx(F,{className:"cursor-pointer",children:e.jsx(L,{placeholder:"Select subject"})}),e.jsx(E,{children:u.map(s=>e.jsxs(x,{value:s.code,children:[s.code," - ",s.title]},s.code))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Assessment Type"}),e.jsxs(T,{value:y,onValueChange:q,children:[e.jsx(F,{className:"cursor-pointer",children:e.jsx(L,{placeholder:"All types"})}),e.jsxs(E,{children:[e.jsx(x,{value:"all",children:"All Types"}),e.jsx(x,{value:"quiz",children:"Quiz"}),e.jsx(x,{value:"exam",children:"Exam"}),e.jsx(x,{value:"project",children:"Project"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Search Students"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:"Search by name or email...",value:h,onChange:s=>_(s.target.value),className:"pl-10"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Search Assessments"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:"Search assessments by title or description...",value:N,onChange:s=>$(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",u.length," of ",t.length," subjects"]}),e.jsx(J,{variant:"outline",size:"sm",className:"cursor-pointer",onClick:()=>{Y("all"),q("all"),_(""),$("")},children:"Clear All Filters"})]})]})]}),l&&e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xl",children:l.title}),e.jsxs(Q,{children:[l.code," • ",l.course.name," • Year ",l.year_level," Section"," ",l.section]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:"secondary",children:l.course.code}),e.jsxs(v,{variant:"outline",children:[S(l).length," student",S(l).length!==1?"s":""]})]})]})}),e.jsxs(f,{children:[o(l).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium mb-3",children:["Assessments",N&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",o(l).length," of ",l.assessments.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:o(l).map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(v,{className:ce(s.title),children:s.title}),e.jsxs("span",{className:"text-sm text-gray-500",children:[B(s)," pts"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Created: ",de(s.created_at)]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),s.questions.length," question",s.questions.length!==1?"s":""]})]})]},s.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"text-lg font-medium",children:["Students",h&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",w(l).length," of"," ",S(l).length,")"]})]})}),w(l).length===0?e.jsxs("div",{className:"text-center py-8 border rounded-lg",children:[e.jsx(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-00 mb-2",children:h?"No students found":"No Students Enrolled"}),e.jsx("p",{className:"text-gray-500 mb-4",children:h?"Try adjusting your search terms.":"Add students to this subject to start tracking their progress."})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(K,{children:[e.jsx(W,{children:e.jsxs(z,{children:[e.jsx(C,{className:"w-[200px]",children:"Student"}),o(l).length>0?e.jsx(e.Fragment,{children:o(l).map(s=>e.jsx(C,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.title}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[B(s)," pts"]})]})},s.id))}):e.jsx(C,{children:"Status"})]})}),e.jsx(X,{children:w(l).map(s=>e.jsxs(z,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{className:"h-8 w-8",children:e.jsx(se,{children:s.name.split(" ").map(r=>r[0]).join("")})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})]})}),o(l).length>0?e.jsx(e.Fragment,{children:o(l).map(r=>{const n=ie(r,s.id),d=B(r);return e.jsxs(A,{className:"text-center",children:[e.jsxs("span",{className:`font-medium ${ne(n,d)}`,children:[n,"/",d]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[d>0?(n/d*100).toFixed(0):0,"%"]})]},r.id)})}):e.jsx(A,{children:e.jsx(v,{variant:"secondary",children:"Enrolled"})})]},s.id))})]})})]})]})]}),t.length===0&&e.jsx(j,{children:e.jsxs(f,{className:"text-center py-8",children:[e.jsx(D,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subjects Available"}),e.jsx("p",{className:"text-gray-500",children:"Start by adding subjects to manage grades."})]})})]})})]})}export{_e as default};
